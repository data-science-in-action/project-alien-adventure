---
title: "ARIMA模型对意大利新冠肺炎死亡人数的预测"
author: "戎翔"
date: "2020/5/8"
output: html_document
---
```{r echo=FALSE}
library(tseries)
library(zoo)
library(forecast)
library(fUnitRoots)
library(readxl)
sw <- read_excel("D:/ydl.xlsx")
sw1=ts(sw,start = 1,frequency = 1)
```

## 肺炎是重要公共卫生问题，尽管对肺炎防治已有安全有效的抗生素和疫苗，ＷＨＯ报告肺炎仍是全球最主要死因和首位传染病死因。近期研究估计中国每年有２５０万肺炎病例，其中１２．５万（５％）死于肺炎相关疾病。２００３年后，不明原因肺炎监测得到重视，纳入医院监测中。而新型冠状病毒肺炎（以下简称新冠肺炎）传染性极强，人群普遍易感，自暴发疫情后，迅速在全球蔓延，对全球经济生产、民生等方面造成极大影响。各国应当结合实际出台系列政策措施，有效遏制疫情扩散蔓延。随着疫情发展进入转折，亟待从各地区实际情况出发，杜绝形式主义，科学分区分级，实现精准防控。本文利用意大利新冠疫情的监测数据，探索建立ＡＲＩＭＡ模型对未来死亡人数进行预测，以期为估算肺炎造成的疾病负担，政策制定和财政预算提供参考。
## 材料与方法
## 资料来源 　
## 1.1资料来源于世界卫生组织官网。
## 1.2ARIMA模型即自回归移动平均模型，时间序列分析模型通常是指求和自回归移动平均模型（Autoregressive integrated moving average，ARIMA），由统计学家Box和Jenkins于1970年首次系统提出，以数理统计和微积分等传统数学理论为基础建立起来的预测模型，是时间序列分析方法中应用比较广泛的方法之一，短期预测准确率较高。在病预测等方面得到广泛应用。根据序列特征，可分为平稳和非平稳时间序列。对于非平稳时间序列，可以通过d次差分运算将其转换为平稳时间序列，此时即为ARIMA。ＡＲＩＭＡ模型的形式可表示为ＡＲＩＭＡ（ｐ，ｄ，ｑ）。ｐ、ｄ、ｑ分别表示自回归阶数、差分阶数和移动平均阶数。模型构建过程包括数据时间序列平稳化、模型识别、参数估计和模型检验。本研究收集今年3月1号到5月4号意大利疫情数据，用ARIMA模型对死亡人数进行模型构建、拟合，并应用最优模型参数预测意大利疫情发展趋势，以期发现意大利疫情的潜在变化规律，为开展防控工作提供理论依据
## 资料与方法
## 2资料
## 收集今年3月1号到5月4号意大利疫情数据，资料来源于世卫组织官网。
## 2.1ＡＲＩＭＡ模型的建立
## 2.1平稳性和白噪声（White noise）检验 ARIMA建模要求序列为平稳且是非随机性序列，若数据为非平稳时间序列，则可对原序列进行差分运算使其转换为平稳序列。白噪声检验，也称为纯随机性检验，主要用来检验数据是否为纯随机序列。本研究主要用单位根ADF的方法进行平稳性检验；计算LB统计量进行白噪声检验
## 2.2 模型识别和定阶 对平稳非白噪声差分序列，依据自相关图（ACF）和偏自相关图（PACF）初步选择合适的模型参数进行拟合。模型定阶根据最小信息量原则（Akaike information criterion，AIC）和贝叶斯信息准则（Bayesian information criterion，BIC）进行，AIC和BIC值最小的模型为最佳
## 2.3 参数估计与模型检验 在模型识别阶段，采用最大似然法对粗模型进行参数估计与显著性检验。模型显著性检验即残差白噪声检验，是检验模型是否充分提取了序列信息，即残差是否为白噪声。若是，则构建的模型可以用于预测；否则，返回第2步重新
## 2.4 模型预测 建立3月1号到5月4号意大利新冠肺炎死亡人数变化模型进行预测
## 3 统计分析
## 建模
## 意大利3月1号到5月4死亡人数数据绘制时间序列图，可见明显的递增趋势，长期而言呈递增速度在减慢，为不平稳序列，因此对其2阶差分以使其平稳

```{r echo=TRUE}
plot(sw1,ylab='死亡人数')
```

## 尽管有文献提及肺炎发病具有季节性，但就此次而言，由于是新型肺炎，之前未发生过，数据也少，故不宜进行季节性差分。经处理后，原始数据趋于平滑，对数据进行处理后的自相关函数（ＡＣＦ）分析图与偏自相关函数（ＰＡＣＦ）分析图，如下图所示

```{r echo=TRUE}
tsdisplay(diff(sw1,1,2))
```

```{r echo=TRUE}
ndiffs(sw1)
```
## 上述这个函数可以用来快速检测出该序列是几阶平稳

```{r echo=TRUE}
adfTest(diff(sw1,1,2),lags = 2,type = 'nc') 
Box.test(diff(sw1,1,2),lag = 6)
```
## 根据上述分析结果始序列sw1二阶差分后为平稳序列，并且不是白噪声序列，即序列中包括有意义的数据，继续拟合模型。由acf图拖尾和pacf图截尾可尝试拟合ARIMA(2,2,0)。为了避免考虑不足，还拟合了ARIMA(2,2,1)和ARIMA(2,2,2)作为比较。
## ARIMA(2,2,0)
```{r echo=TRUE}
f220=arima(sw1,order = c(2,2,0))
f220
```

```{r echo=TRUE}
Box.test(f220$residuals,lag = 6)
Box.test(f220$residuals,lag = 12)
BIC(f220)
```
## 可知ARIMA(2,2,0)的系数都是显著的，而且残差是白噪声序列，说明对原始信息提取较好。经过比较，ARIMA(2,2,1)和ARIMA(2,2,2)的参数全部不显著，AIC和BIC均大于ARIMA(2,2,0)的AIC和BIC，尽管它们通过了残差白噪声检验。

## 模型预测与应用
## 应用该预测模型对5月5、6、7号进行预测
```{r echo=TRUE}
forecast(f220,h=3)
plot(forecast(f220,h = 3))
```

## 5、6、7号实际死亡人数为29315人、29684人、29958人，模型拟合比较好

## 讨 论
## 疾病的统计学预测实际应用中，回归分析和时间序列分析是常用的2种方法。回归分析主要侧重于各种因素对预测对象造成的影响，建立能反映影响因素和预测对象之间规律性的数学模型，从而进行预测。但是，新冠肺炎的流行与气候、自然环境、生产生活方式、经济发展水平等诸多自然和社会因素均有密切联系，具有复杂性和不确定性。因此，采用回归模型时，自变量的选择是该方法的关键。而时间序列分析模型是动态分析和预测疾病发展规律的有力工具，可以研究自变量在时间演变过程的变化。时间序列分析和回归分析一样，都是统计学中预测方法的重要分支。该方法研究预测对象的历史数据随时间发展的演变规律，并建立数学模型进行外推。时间序列分析与预测现已广泛应用于各领域，尤其是在预测变量的主要影响因素未知，或者主要影响因素已知，但相关数据较难收集时，其优越性更为突出。ARIMA模型应用于疾病研究和防控方面，预测效果较好。但是，该模型做单步预测效果较好，多步预测可能就不太理想。因此，ARIMA模型一般只适用于发病率的中短期预测。实际运用中应尽可能多收集相关数据，确保数据的可靠性，使用最新数据对已建立的模型进行验证；同时可以不断加入新的实际值对模型重新进行拟合，使其更加符合实际情况，提高预测效果。时间序列预测法在资料收集方面要求不高、成本较低，符合目前意大利疫情数据的实际情况，为疫情监测预警提供了一个有效的技术手段，有着广阔的应用前景。


