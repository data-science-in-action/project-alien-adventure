---
title: "意大利新冠肺炎疫情预测及理性评估"
author: "戎翔 高彦梅 卫晓帆 李宇"
date: "2020年6月12日"
output: ioslides_presentation
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

## 1 引言


- 1.1 背景及研究内容

- 1.2 文献综述


## 1.1 背景及研究内容

&emsp;&emsp;2019年12月，我国湖北省武汉市陆续出现多起不明原因的病毒性肺炎，一种新发现的冠状病毒随即被确认为导致武汉不明原因肺炎病例的病原体。2020年1月12日，世界卫生组织将该病毒命名为“2019新型冠状病毒(2019-nCoV)”，同年2月11日，国际病毒分类委员会又将其正式更名为严重急性呼吸综合征冠状病毒2(SARS-Cov-2)，世界卫生组织于同日该病毒导致的疾病正式命名为2019新型冠状病毒疾病(COVID-19)，国家卫健委随后将新型冠状病毒肺炎的英文缩写标准化为COVID-19。COVID-19传染性极强，迅速从武汉蔓延至全国各地，并在境外多个国家和地区传播，波及全球200多个国家。

---

&emsp;&emsp;根据最新数据统计，全球新冠肺炎累计确诊病例数突破731万例。目前，全球有8个国家累计确诊数超过20万，其中，美国累计确诊病例已经突破204万例，意大利、巴西等7个国家的累计确诊病例最新突破20万。此次新冠肺炎疫情给全世界带来了前所未有的挑战，其后续影响难以估量。意大利作为世界旅游业较发达的国家之一，也不可避免地受到了严重的影响。这种影响不仅发生于意大利与其他国家之间，更发生于意大利国内的方方面面。

&emsp;&emsp;因此，本文分别利用指数平滑以及ARIMA模型对意大利新冠肺炎情况进行了预测分析，并利用灰色系统分析方法具体定量分析新冠肺炎对2020年意大利旅游收入产生的损失。

## 1.2 文献综述

[1]林硕蕾.灰色系统在经济上的应用-定量分析SARS对旅游外汇收入的影响

&emsp;&emsp;文献利用灰色系统理论建立GM（1,1）模型，由1997-2002年旅游外汇收入的平均值预测2003年旅游外汇收入平均值；并通过历史数据计算每个月的指标值与全年总值的关系，得出每个月旅游外汇收入所占全年旅游收入的权重，从而预测出正常情况下2003年每个月外汇旅游收入的指标值；最后将其与2003年每月外汇旅游收入的真实值进行比较，定量分析SARS对旅游外汇收入的影响。

[2]王旭艳,喻勇,胡樱,宇传华.基于指数平滑模型的湖北省新冠肺炎疫情预测分析[J].公共卫生与预防医学,2020,31(01):1-4.

&emsp;&emsp;王旭艳等人利用1月23日到3月25日湖北省疫情数据，采用平滑指数模型对湖北省新冠肺炎疫情变化趋势进行分析和预测。结果表明，采用指数平滑模型获得的拟合值与实际值的趋势基本吻合，模型拟合效果较好，预测结果表明在4月2日现存确诊病例数将减少至1000例以内，且主要为重症和危重症病例。

---

[3]严婧，杨北方.指数平滑法与ARIMA模型在湖北省丙型病毒性肝炎发病预测中的应用

&emsp;&emsp;研究对湖北省丙肝疫情资料进行整理，将2004年1月－2014年12月丙肝发病数据作为建模部分，2015年1－12月发病数据作为模型验证分部，对丙肝不同年份发病率进行趋势卡方检验，建立 ARIMA模型和指数平滑法，并进行模型的参数估计、拟合检验、计算和预测、检验与评价。将预测值与实际值 进行比较，计算相对误差绝对值，相对误差绝对值越小说明预测越准确，然后进行型预测效果比较。

## 2 数据来源及描述统计


- 2.1 数据来源

- 2.2 意大利疫情基本描述

- 2.3 疫情下的意大利旅游经济


## 2.1 数据说明

&emsp;&emsp;疫情数据来源于世界卫生组织官网(https://www.who.int/)，选取意大利3月1日-6月7日的数据，具体包括累计确诊人数、新增确诊人数、累计治愈、新增治愈人数、累计死亡人数以及新增死亡人数。根据每日疫情数据，可以依据累计确诊人数、累计死亡人数以及累计治愈人数求得现存确诊人数，以及移除人数，其中现存确诊人数=累计确诊人数-累计死亡人数-累计治愈人数，移除人数=累计死亡人数+累计治愈人数。

&emsp;&emsp;有关意大利旅游收入的数据来源于(https://zh.tradingeconomics.com/)。为了避免2008年金融危机对本次分析产生影响，我们选取2009年-2020年的数据。


## 2.2 意大利疫情基本描述

```{r ,out.height="80%", out.width="90%",fig.align='center', echo=FALSE}
knitr::include_graphics("D:/1wxf/project-alien-adventure/final repo/pic/2.1.png")
```

&emsp;&emsp;截至6月7日，意大利累计确诊人数达23万之多，累计病例数从3月初开始迅速增加，到5月份左右减缓，而后趋于稳定，尤其在近日以来，新增确诊病例数在200左右波动，并且在不断减少，说明意大利疫情得到了较好的控制。

---

```{r ,out.height="80%", out.width="90%",fig.align='center', echo=FALSE}
knitr::include_graphics("D:/1wxf/project-alien-adventure/final repo/pic/2.2.png")
```

&emsp;&emsp;随着新增确诊人数的先增后减，增长率曲线也呈现出先增后减的趋势，在3月1日-3月22日期间，增长率大于10%，而后逐渐减小，在4月29日以后增长率均小于1%，并逐渐趋向于0，说明意大利的COVID-19得到了有效控制。

## 2.3 疫情下的意大利旅游经济

```{r,out.height="80%", out.width="90%", fig.align='center', echo=FALSE}
knitr::include_graphics("D:/1wxf/project-alien-adventure/final repo/pic/2.3.png")
```

&emsp;&emsp;意大利2009-2020年的旅游收入走势图显示，旅游收入逐年上升，并呈规律性的周期变化，在每年7月份左右旅游收入最高，1月份左右最低。由于COVID-19的影响，意大利2020年的旅游收入在一月份下滑后并没有回升，甚至在3月份降到了483.48百万欧元，降到了近十年的最低点，可见COVID-19疫情对意大利经济有着不容忽视的影响。

## 3.实证分析

## 3.1 指数平滑法

## 3.2 ARIMA模型

---

## 3.1.1指数平滑模型理论

&emsp;&emsp;指数平滑预测法是一种确定性的平滑预测法。其实质是通过计算指数平滑平均数来平滑时间序列,消除历史统计序列中的随机波动,以找出其主要发展趋势。根据设置参数的不同可以分为单指数预测,双指数预测,和三指数预测。
    
&emsp;&emsp;同时，指数平滑法也广泛应用于传染病发病率的预测，如流感样病例、肝炎等，其基本思想是预测值为历史观测值的加权和，且对不同的历史数据给予不同的权重，新数据赋予较大的权重，旧数据赋予较小的权重，主要用于中短期预测。一次指数平滑法针对没有趋势和季节性的序列，二次指数平滑法针对有趋势但没有季节性的序列，三次指数平滑法针对有趋势也有季节性的序列。根据新冠肺炎疫情数据的特征，本文采用二次指数平滑法进行预测。

---

## 3.1.2指数平滑法的应用

&emsp;&emsp;我们对累计确诊人数使用R中的HoltWinters()进行霍尔特指数平滑预测,并绘出预测和观测值的曲线图，来观看预测结果。

```{r echo=FALSE}
h<-read.table(file="D:/1wxf/project-alien-adventure/final repo/data/Italy.csv",sep=",",header = T)
rem<-h$total.deaths+h$total.cure##移除人数
ncon<-h$total.confirmed-rem##现有确诊人数
ljqz<-h$total.confirmed
xzqz<-h$total.confirmed.new.cases
ljsw<-h$total.deaths
xzsw<-h$total.new.deaths
ljzy<-h$total.cure
xzzy<-h$total.cure.new.cases
tcforecasts<-HoltWinters(ljqz, gamma=FALSE)
p4<-plot(tcforecasts,xlab="time",ylab="total confirmed",sub="图4 累计确诊趋势图")
```

---
&emsp;&emsp;总体看来，预测的效果还不错（黑色为原始序列，红色为预测值）,这两条线几乎吻合。

```{r echo=FALSE}  
tcforecasts
```

&emsp;&emsp;相关预测值如图所示，alpha值为1，beta预测值为0.6313，这些值较大，充分显示了无论是水平上还是趋势的斜率上，当前值对时间序列上的最近的观测值的依赖关系比较重，这符合我们的预期。并利用第一期的数据进行调整，结果如图所示：

---
```{r echo=FALSE}  
HoltWinters(ljqz, gamma=FALSE, l.start=1128, b.start=561)
```

---
&emsp;&emsp;下面采用forecast包预测未来20天的累计确诊人数，预测图如下所示，图中预测部分使用蓝色的线条标识出来，深灰色的阴影区域为80%，浅灰色阴影区为95%的预测区间。

```{r echo=FALSE}
library("forecast")
tcforecasts2<-forecast(tcforecasts, h=20)
p5<-plot(tcforecasts2,xlab="time",ylab="total confirmed",sub="图5 累计确诊趋势预测图")
```

---
&emsp;&emsp;为了检验预测效果，检验延迟1-20阶中的预测误差是否非零自相关，同样继续采用Ljung-Box检验，检验结果如下：

```{r echo=FALSE}
Box.test(tcforecasts2$residuals, lag=2, type="Ljung-Box")
```

&emsp;&emsp;经过检验发现，p值大于0.05，说明不存在残差自相关的问题。因此可以做指数平滑模型。

---
&emsp;&emsp;下面列出未来20天的累计确诊人数，如下表所示：
```{r echo=FALSE}
tcforecasts2
```

&emsp;&emsp;从表中数据可以看出，累计确诊人数还会继续增加，但明显增幅减小。

---
&emsp;&emsp;为进一步了解意大利的疫情情况，本文将对现存确诊病例数进行预测，结果如下图所示：

```{r echo=FALSE}
nconforecasts<-HoltWinters(ncon, gamma=FALSE)
p6<-plot(nconforecasts,xlab="time",ylab="now confirmed",sub="图6 现存确诊趋势图")
```

&emsp;&emsp;从图形来看，两条曲线基本吻合，并且根据预测的alpha值与beta值的情况，这些数据符合我们的预期。

---

```{r echo=FALSE}  
nconforecasts
```

&emsp;&emsp;同理，对上述的参数进行调整，结果如下所示,alpha值与beta值较大，充分显示了无论是水平上还是趋势的斜率上，当前值对时间序列上的最近的观测值的依赖关系比较重，这是符合预期的。

---
```{r echo=FALSE}
HoltWinters(ncon, gamma=FALSE, l.start=1016, b.start=489)
```

---
&emsp;&emsp;下面对未来20天的现存确诊人数进行预测,预测结果显示，未来20天，现存确诊人数继续下降，下降趋势基本平稳。

```{r echo=FALSE}
library("forecast")
nconforecasts2<-forecast(nconforecasts, h=20)
p7<-plot(nconforecasts2,xlab="time",ylab="now confirmed",sub="图7 现存确诊趋势预测图")
```

---

&emsp;&emsp;为了检验预测效果，检验延迟1-20阶中的预测误差是否非零自相关，同样继续采用Ljung-Box检验，检验结果如下：

```{r echo=FALSE}
Box.test(nconforecasts2$residuals, lag=5, type="Ljung-Box")
```

&emsp;&emsp;经过检验发现，p值大于0.05，说明不存在残差自相关的问题。因此可以做指数平滑模型。

---

&emsp;&emsp;下面列出未来20天的现存确诊人数，如下表所示：

```{r echo=FALSE}
nconforecasts2
```

&emsp;&emsp;从表中可以看出，预计在6月12日，意大利现存确诊人数将减少到3万以下。


## 4 基于arima模型对意大利新冠肺炎死亡人数的预测

- 4.1 方法介绍

- 4.2 ARIMA模型的建立

- 4.3 统计分析

- 4.4 模型预测与应用

## 4.1 方法介绍

&emsp;&emsp;ARIMA模型即自回归移动平均模型，时间序列分析模型通常是指求和自回归移动平均模型(Autoregressive integrated movingaverage，ARIMA)，由统计学家Box和Jenkins于1970年首次系统提出，以数理统计和微积分等传统数学理论为基础建立起来的预测模型，是时间序列分析方法中应用比较广泛的方法之一，短期预测准确率较高。在病预测等方面得到广泛应用。根据序列特征，可分为平稳和非平稳时间序列。对于非平稳时间序列，可以通过d次差分运算将其转换为平稳时间序列，此时即为ARIMA。ARIMA模型的形式可表示为ARIMA(p,d,q)。p,d,q分别表示自回归阶数、差分阶数和移动平均阶数。模型构建过程包括数据时间序列平稳化、模型识别、参数估计和模型检验。本研究收集今年3月1号到6月7号意大利疫情数据，用ARIMA模型对死亡人数进行模型构建、拟合，并应用最优模型参数预测意大利疫情发展趋势，以期发现意大利疫情的潜在变化规律，为开展防控工作提供理论依据。

## 4.2 ARIMA模型的建立

### 平稳性和白噪声（White noise）检验

&emsp;&emsp;ARIMA建模要求序列为平稳且是非随机性序列，若数据为非平稳时间序列，则可对原序列进行差分运算使其转换为平稳序列。白噪声检验，也称为纯随机性检验，主要用来检验数据是否为纯随机序列。本研究主要用单位根ADF的方法进行平稳性检验；计算LB统计量进行白噪声检验。

### 模型识别和定阶 

&emsp;&emsp;对平稳非白噪声差分序列，依据自相关图（ACF）和偏自相关图（PACF）初步选择合适的模型参数进行拟合。模型定阶根据最小信息量原则（Akaikeinformationcriterion，AIC）和贝叶斯信息准则（Bayesia information criterion，BIC）进行，AIC和BIC值最小的模型为最佳。

---

### 参数估计与模型检验 
&emsp;&emsp;在模型识别阶段，采用最大似然法对粗模型进行参数估计与显著性检验。模型显著性检验即残差白噪声检验，是检验模型是否充分提取了序列信息，即残差是否为白噪声。若是，则构建的模型可以用于预测；否则，返回第2步重新。

### 模型预测 
&emsp;&emsp;建立3月1号到6月7号意大利新冠肺炎死亡人数变化模型进行预测

## 4.3 统计分析

```{r ,out.height="70%", out.width="70%",fig.align='center', echo=FALSE}
knitr::include_graphics("D:/1wxf/project-alien-adventure/final repo/pic/4.1.png")
```
&emsp;&emsp;意大利3月1号到6月7死亡人数数据绘制时间序列图，可见明显的递增趋势，长期而言呈递增速度在减慢，为不平稳序列，因此对其2阶差分以使其平稳.

---

&emsp;&emsp;尽管有文献提及肺炎发病具有季节性，但就此次而言，由于是新型肺炎，之前未发生过，数据也少，故不宜进行季节性差分。根据ndiffs函数可知原为二阶后平稳。经处理后，原始数据趋于平滑，对数据进行处理后的自相关函数（ACF）分析图与偏自相关函数（PACF）分析图，如下图所示.
```{r ,out.height="75%", out.width="80%",fig.align='center', echo=FALSE}
knitr::include_graphics("D:/1wxf/project-alien-adventure/final repo/pic/4.2.png")
```

---

&emsp;&emsp;经过ADF单位根检验，P值小于0.01，显示原始序列二阶差分后为平稳序列。经过白噪声检验，P值小于0.01，证明原始序列二阶差分后不是白噪声序列，即序列中包括有意义的数据，继续拟合模型。由acf图和pacf图以及auto.arima函数，可尝试拟合ARIMA(0,2,1)。ARIMA（2，2，0），ARIMA（1，2，2）

&emsp;&emsp;ARIMA（2，2，0）的系数与标准误相除，绝对值均大于1.96，系数是显著的，残差通过白噪声检验， aic = 1242.48  bic=1250.2。

&emsp;&emsp;ARIMA（1，2，2）虽然系数显著，但是模型不可逆，舍去.AIC=1236.23, BIC=1246.53

&emsp;&emsp;ARIMA（0，2，1）系数显著.残差也通过白噪声检验.aic = 1240.92 ， bic=1246.069

&emsp;&emsp;经过比较，最终选择ARIMA(0,2,1)模型。

## 4.4 模型预测与应用

&emsp;&emsp;应用该预测模型对第100天（6月8号）到第108天（6月16号）进行预测，其预测值分别为：33966，34034，34101，34169，34236，34303，34371，34438，34506.

```{r ,out.height="70%", out.width="70%",fig.align='center', echo=FALSE}
knitr::include_graphics("D:/1wxf/project-alien-adventure/final repo/pic/4.3.png")
```

## 5 总结

&emsp;&emsp;针对意大利新冠肺炎疫情发展情况，本文提出了指数平滑模型和ARIMA模型，分别对意大利累计确诊人数、现存人数和死亡人数进行预测与分析，并利用灰色模型GM(1,1)分析COVID-19疫情对意大利旅游经济的影响。

&emsp;&emsp;指数平滑模型结果显示，6月底，意大利累计确诊人数可能会突破24万，但总体来说，累计确诊人数的增长变缓，整体情况有明显改善。

&emsp;&emsp;ARIMA模型对死亡人数的分析表明，新冠肺炎死亡人数的增长率正日益交降低，趋于平稳。从一开始的指数增长到平稳发展经历了一百天左右的过程，说明意大利现行的疫情政策非常有效果。结合具体预测数据，有理由相信意大利新冠疫情会在最近得到较为充分的控制。

---


&emsp;&emsp;此次疫情除了对意大利造成了严重的人员伤亡外，也对当地的旅游经济产生了很大的冲击，这种冲击在三月份达到了最大，三月份的旅游收入低落到近十年的最低点，这对意大利旅游经济造成了巨大的冲击。但随着疫情的逐渐控制以及当地政府经济政策的实施，相信意大利经济会有所好转。

&emsp;&emsp;综上所述，意大利新冠肺炎疫情情况的改善与政策的实施有密不可分的关系，早在3月10日，意大利便开始实行封锁政策，成为欧洲第一个封国的国家。随着全球疫情不断蔓延，意大利疫情却开始呈现下降趋势，可见，在强有力的政策管控下，意大利新冠肺炎疫情情况得到好转，从最开始的累计确诊人数排名第二到目前的排名第七。因此，在其他地区疫情较为严重且本国尚存在新增确诊病例的情况下，防疫意识不可松懈，仍应该保持警惕，注重个人卫生，在重振经济的同时继续做好防疫工作，尽快取得真正的解放。